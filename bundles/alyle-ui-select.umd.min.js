!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/animations"),require("@angular/forms"),require("@alyle/ui/field"),require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/common"),require("@alyle/ui"),require("@alyle/ui/checkbox")):"function"==typeof define&&define.amd?define("@alyle/ui/select",["exports","@angular/animations","@angular/forms","@alyle/ui/field","rxjs","rxjs/operators","@angular/core","@angular/common","@alyle/ui","@alyle/ui/checkbox"],t):t((e.ly=e.ly||{},e.ly.select={}),e.ng.animations,e.ng.forms,e.ly.field,e.rxjs,e.rxjs.operators,e.ng.core,e.ng.common,e.ly.core,e.ly.checkbox)}(this,function(e,t,i,p,d,o,s,n,c,r){"use strict";var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function u(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function a(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,s=n.call(e),r=[];try{for(;(void 0===t||0<t--)&&!(i=s.next()).done;)r.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(n=s["return"])&&n.call(s)}finally{if(o)throw o.error}}return r}var f=function(e){return{$priority:-2,root:{display:"block",paddingAfter:"1em",minWidth:"3em",minHeight:"1.5em","-webkit-tap-highlight-color":"transparent","&":e.select?e.select.root:null},container:{background:e.background.primary["default"],borderRadius:"2px",boxShadow:c.shadowBuilder(4),display:"block",transformOrigin:"inherit",pointerEvents:"all",overflow:"auto",maxHeight:"256px"},valueText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},option:{display:"flex",fontFamily:e.typography.fontFamily,color:e.text["default"],"-webkit-tap-highlight-color":"transparent",backgroundColor:"rgba(0, 0, 0, 0)",border:0,padding:"0 1em",margin:0,outline:"none",boxSizing:"border-box",position:"relative",justifyContent:"flex-start",alignItems:"center",alignContent:"center","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none",userSelect:"none",lineHeight:"3em",height:"3em",cursor:"pointer"},optionText:{"ly-checkbox ~ &":{marginBefore:"-16px"}},content:{padding:0,display:"flex",justifyContent:"inherit",alignItems:"inherit",alignContent:"inherit",width:"100%",height:"100%",boxSizing:"border-box"}}},_=[t.trigger("selectEnter",[t.transition("void => in",[t.animate("125ms cubic-bezier(0, 0, 0.2, 1)",t.keyframes([t.style({opacity:0,transform:"scaleY(0.9)"}),t.style({opacity:1,transform:"scaleY(1)"})]))])]),t.trigger("selectLeave",[t.transition("* => void",t.animate("100ms 25ms linear",t.style({opacity:0})))])],h=function E(){},y=c.mixinTabIndex(h),g=function(h){function e(e,t,n,i,o,s,r,l,a,c){var u=h.call(this)||this;return u._theme=e,u._renderer=t,u._el=n,u._overlay=i,u._field=o,u._cd=s,u._ngZone=r,u.ngControl=l,u._parentForm=a,u._parentFormGroup=c,u.classes=u._theme.addStyleSheet(f),u._disabled=!1,u._required=!1,u.stateChanges=new d.Subject,u._form=u._parentForm||u._parentFormGroup,u._valueKey=C,u._valueKeyFn=x,u._focused=!1,u.errorState=!1,u._destroy=new d.Subject,u.onChange=function(e){},u.onTouched=function(){},u.ngControl&&(u.ngControl.valueAccessor=u),u._cursorClass=u._theme.addStyle("lyField.select",{"& {container}":{cursor:"pointer"}},u._field._getHostElement(),null,-2,p.STYLES),u}return u(e,h),e.prototype._onBlur=function(){!1===this._focused||this._opened||(this._focused=!1,this.stateChanges.next())},e.prototype._onFocus=function(){!0===this._focused||this.disabled||(this._focused=!0,this.stateChanges.next())},e.prototype._endAnimation=function(e){"void"===e.toState&&this._overlayRef&&(this._overlayRef.remove(),this._overlayRef=null)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){var n=this;if(e!==this.value&&this._selectionModel){if(this._value=e,this.writeValue(e),this.options)if(this.multiple){if(Array.isArray(this.value)){var i=[];if(this.options.forEach(function(t){n.value.some(function(e){return n._valueKey(e)===n._valueKeyFn(t)})&&i.push(t)}),i.length){var t=this._selectionModel.selected;this._selectionModel.clear(),i.forEach(function(e){return e.select()}),t.length&&t.forEach(function(e){e.ngOnChanges(),e._cd.markForCheck()})}}}else{var o=this._selectionModel.selected;this._selectionModel.clear(),o.length&&o.forEach(function(e){e.ngOnChanges(),e._cd.markForCheck()});var s=this.options.find(function(e){return n._valueKeyFn(e)===n.valueKey(n.value)});s&&s.select()}this.stateChanges.next(),this._cd.markForCheck()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled},set:function(e){e!==this._disabled&&(this._disabled=c.toBoolean(e),this._field&&(!e&&this._hasDisabledClass?(this._renderer.removeClass(this._field._getHostElement(),this._field.classes.disabled),this._cursorClass&&this._renderer.addClass(this._field._getHostElement(),this._cursorClass),this._hasDisabledClass=undefined):e&&(this._renderer.addClass(this._field._getHostElement(),this._field.classes.disabled),this._cursorClass&&this._renderer.removeClass(this._field._getHostElement(),this._cursorClass),this._hasDisabledClass=!0)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"required",{get:function(){return this._required},set:function(e){this._required=c.toBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiple",{get:function(){return this._multiple},set:function(e){this._multiple=c.toBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueKey",{get:function(){return this._valueKey},set:function(t){this._valueKeyFn=function(e){return t(x(e))},this._valueKey=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){this._placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focused",{get:function(){return this._focused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){var e=this.value;return this.multiple?this._selectionModel.isEmpty():null==e||this._selectionModel.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"floatingLabel",{get:function(){return!!this._opened||!this.empty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"triggerValue",{get:function(){if(this._multiple){var e=this._selectionModel.selected.map(function(e){return e.viewValue});return this._theme.variables.direction===c.Dir.rtl&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){var e=this._selectionModel.selected;return this.multiple?e.map(function(e){return e.value}):e[0].value},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this._selectionModel=new c.LySelectionModel({multiple:!!this.multiple||undefined,getKey:this._valueKeyFn});var t=this.ngControl;t&&t.statusChanges&&t.statusChanges.pipe(o.takeUntil(this._destroy)).subscribe(function(){e.disabled=!!t.disabled}),this._renderer.addClass(this._field._getHostElement(),this._field.classes.selectArrow),this._renderer.addClass(this._el.nativeElement,this._field.classes.inputNative),this._renderer.addClass(this._el.nativeElement,this.classes.root)},e.prototype.ngDoCheck=function(){var e=this.errorState,t=!!(this.ngControl&&this.ngControl.invalid&&(this.ngControl.touched||this._form&&this._form.submitted));if(t!==e&&(this.errorState=t,this._field)){var n=this._field.classes.errorState;t?(this._renderer.addClass(this._field._getHostElement(),n),this._errorClass=n):this._errorClass&&(this._renderer.removeClass(this._field._getHostElement(),n),this._errorClass=undefined),this.stateChanges.next()}},e.prototype.ngAfterContentInit=function(){var e=this;Promise.resolve().then(function(){e.value=e.ngControl?e.ngControl.value:e._value,e.stateChanges.next(),e._cd.markForCheck()})},e.prototype.ngAfterViewInit=function(){var n=this;this.options&&this.options.changes.pipe(o.takeUntil(this._destroy)).subscribe(function(){var t=[];n.options.forEach(function(e){e.isSelected&&t.push(e)}),t.length&&(n._selectionModel.clear(),t.forEach(function(e){return n._selectionModel.select(e)}))})},e.prototype.ngOnDestroy=function(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._overlayRef&&this._overlayRef.destroy()},e.prototype.open=function(){var e=this;this.disabled||(this._opened=!0,this.stateChanges.next(),this._overlayRef=this._overlay.create(this.templateRef,null,{styles:{top:0,left:0,pointerEvents:null},fnDestroy:this.close.bind(this),onResizeScroll:this._updatePlacement.bind(this)}),this._ngZone.onStable.pipe(o.take(1)).subscribe(function(){return e._updatePlacement()}))},e.prototype.close=function(){this._overlayRef&&(this.onTouched(),this._overlayRef.detach(),this._opened=!1,this._getHostElement().focus(),this.stateChanges.next())},e.prototype.onContainerClick=function(){this.open(),this._getHostElement().focus()},e.prototype.focus=function(){this._getHostElement().focus()},e.prototype._getHostElement=function(){return this._el.nativeElement},e.prototype.writeValue=function(e){this.options&&(this.value=e)},e.prototype.registerOnChange=function(t){var n=this;this.onChange=function(e){t(n.value)}},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this.disabled=e,this._cd.markForCheck(),this.stateChanges.next()},e.prototype._updatePlacement=function(){var e,t=this._overlayRef.containerElement,n=t.querySelector("div"),i=this.valueTextDivRef.nativeElement;e=this.multiple?i.offsetWidth+64:i.offsetWidth+32,this._renderer.setStyle(n,"height","initial"),this._renderer.setStyle(n,"width",e+"px");var o=this._selectionModel.isEmpty()?t.querySelector("ly-option"):this._selectionModel.selected[0]._getHostElement(),s={y:-(i.offsetHeight/2+o.offsetTop+o.offsetHeight/2),x:-16};n.scrollHeight!==n.offsetHeight&&(n.scrollTop=o.offsetTop,n.scrollTop===o.offsetTop?n.scrollTop=n.scrollTop-n.offsetHeight/2+o.offsetHeight/2:n.scrollTop=n.scrollTop-(n.offsetHeight/2-(o.offsetTop-n.scrollTop))+o.offsetHeight/2,s.y=n.scrollTop+s.y),this.multiple&&(s.x-=24);var r=new c.Positioning(c.YPosition.below,c.XPosition.after,null,i,t,this._theme.variables,s,!1);this._renderer.setStyle(t,"transform","translate3d("+r.x+"px, "+r.y+"px, 0)"),this._renderer.setStyle(t,"transform-origin",r.ox+" "+r.oy+" 0"),this._renderer.setStyle(n,"height",r.height);var l="initial"===r.width?e+"px":r.width;this._renderer.setStyle(n,"width",l)},e.decorators=[{type:s.Component,args:[{selector:"ly-select",template:'<div [className]="classes.valueText" #valueText>{{ empty ? \'\\u00A0\' : triggerValue }}</div>\n<ng-template>\n  <div #container [className]="classes.container" [@selectEnter]="\'in\'" (@selectLeave.done)="_endAnimation($event)">\n    <ng-content></ng-content>\n  </div>\n</ng-template>',changeDetection:s.ChangeDetectionStrategy.OnPush,exportAs:"lySelect",host:{"[attr.tabindex]":"tabIndex"},animations:function n(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e}(_),inputs:["tabIndex"],providers:[{provide:p.LyFieldControlBase,useExisting:e}]}]}],e.ctorParameters=function(){return[{type:c.LyTheme2},{type:s.Renderer2},{type:s.ElementRef},{type:c.LyOverlay},{type:p.LyField,decorators:[{type:s.Optional}]},{type:s.ChangeDetectorRef},{type:s.NgZone},{type:i.NgControl,decorators:[{type:s.Optional},{type:s.Self}]},{type:i.NgForm,decorators:[{type:s.Optional}]},{type:i.FormGroupDirective,decorators:[{type:s.Optional}]}]},e.propDecorators={templateRef:[{type:s.ViewChild,args:[s.TemplateRef]}],valueTextDivRef:[{type:s.ViewChild,args:["valueText"]}],_options:[{type:s.ViewChild,args:[s.forwardRef(function(){return b})]}],options:[{type:s.ContentChildren,args:[s.forwardRef(function(){return b}),{descendants:!0}]}],_onBlur:[{type:s.HostListener,args:["blur"]}],_onFocus:[{type:s.HostListener,args:["focus"]}],value:[{type:s.Input}],disabled:[{type:s.Input}],required:[{type:s.Input}],multiple:[{type:s.Input}],valueKey:[{type:s.Input}],placeholder:[{type:s.Input}]},e}(y),m=function O(e,t){this._theme=e,this._ngZone=t},v=c.mixinStyleUpdater(c.mixinBg(c.mixinColor(c.mixinRaised(c.mixinDisabled(c.mixinOutlined(c.mixinElevation(c.mixinShadowColor(c.mixinDisableRipple(m))))))))),b=function(a){function e(e,t,n,i,o,s,r){var l=a.call(this,o,r)||this;return l._select=e,l._el=t,l._rippleService=n,l._cd=s,l.classes=l._theme.addStyleSheet(f,-2),i.addClass(t.nativeElement,l.classes.option),l.setAutoContrast(),l._triggerElement=t,l}return u(e,a),e.prototype._onClick=function(){this._select.multiple?this.toggle():(this.select(),this._select.close()),this._select.onChange(this._select._value)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewValue",{get:function(){return(this._getHostElement().textContent||"").trim()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_color",{get:function(){return this._select._selectionModel.isSelected(this)?this._select._field.color:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSelected",{get:function(){return this._select._selectionModel.isSelected(this)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){null==this.disableRipple&&(this.disableRipple=!1)},e.prototype.ngOnChanges=function(){this.updateStyle(this._el)},e.prototype.select=function(){if(!this.disabled){if(this._select.multiple){var e=this._select._selectionModel.selected;this._select._selectionModel.select(this),this._select._value=this._select._selectionModel.selected.map(function(e){return e.value}),this.updateStyle(this._el),e.length&&e.forEach(function(e){return e.ngOnChanges()})}else if(!this._select._selectionModel.isSelected(this)){e=this._select._selectionModel.selected;this._select._selectionModel.select(this),this._select._value=this._value,this.updateStyle(this._el),e.length&&e.forEach(function(e){return e.ngOnChanges()})}this._select._cd.markForCheck(),this._select.stateChanges.next(),this._cd.markForCheck()}},e.prototype.toggle=function(){if(!this.disabled){if(this._select.multiple){var e=this._select._selectionModel.selected;this._select._selectionModel.toggle(this),this._select._value=this._select._selectionModel.selected.map(function(e){return e.value}),this.updateStyle(this._el),e.length&&e.forEach(function(e){return e.ngOnChanges()})}else if(!this._select._selectionModel.isSelected(this)){e=this._select._selectionModel.selected;this._select._selectionModel.toggle(this),this._select._value=this._value,this.updateStyle(this._el),e.length&&e.forEach(function(e){return e.ngOnChanges()})}this._select._cd.markForCheck(),this._select.stateChanges.next(),this._cd.markForCheck()}},e.prototype._getHostElement=function(){return this._el.nativeElement},e.decorators=[{type:s.Component,args:[{selector:"ly-option",template:'<span [className]="classes.content">\n  <ly-checkbox [disabled]="disabled"\n    [color]="_color"\n    [checked]="isSelected"\n    *ngIf="_select.multiple"\n    (click)="$event.preventDefault()"\n  ></ly-checkbox>\n  <span [className]="classes.optionText"><ng-content></ng-content></span>\n</span>\n<div #rippleContainer [className]="_rippleService.classes.container"></div>',changeDetection:s.ChangeDetectionStrategy.OnPush,inputs:["bg","color","raised","disabled","outlined","elevation","shadowColor","disableRipple"]}]}],e.ctorParameters=function(){return[{type:g,decorators:[{type:s.Host}]},{type:s.ElementRef},{type:c.LyRippleService},{type:s.Renderer2},{type:c.LyTheme2},{type:s.ChangeDetectorRef},{type:s.NgZone}]},e.propDecorators={_rippleContainer:[{type:s.ViewChild,args:["rippleContainer"]}],_onClick:[{type:s.HostListener,args:["click"]}],value:[{type:s.Input,args:["value"]}]},e}(v);function C(e){return e}function x(e){return e.value}var S=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{declarations:[g,b],imports:[n.CommonModule,c.LyCommonModule,r.LyCheckboxModule,c.LyOverlayModule],exports:[g,b,c.LyCommonModule]}]}],e}();e.STYLES=f,e.LySelectBase=h,e.LySelectMixinBase=y,e.LySelect=g,e.LyOptionBase=m,e.LyOptionMixinBase=v,e.LyOption=b,e.LySelectModule=S,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=alyle-ui-select.umd.min.js.map