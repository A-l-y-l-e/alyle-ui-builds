{"version":3,"file":"alyle-ui-tooltip.js.map","sources":["ng://@alyle/ui/tooltip/tooltip.ts","ng://@alyle/ui/tooltip/tooltip.module.ts"],"sourcesContent":["import {\n  ChangeDetectorRef,\n  Directive,\n  ElementRef,\n  Input,\n  NgZone,\n  OnDestroy,\n  TemplateRef,\n  OnInit,\n  Renderer2\n  } from '@angular/core';\nimport {\n  LY_COMMON_STYLES,\n  LyFocusState,\n  LyOverlay,\n  LyTheme2,\n  OverlayFromTemplateRef,\n  Placement,\n  Platform,\n  ThemeVariables,\n  WindowScrollService,\n  XPosition,\n  YPosition,\n  getPosition\n  } from '@alyle/ui';\nimport { Subscription } from 'rxjs';\n\nconst DEFAULT_PLACEMENT = YPosition.below;\nconst STYLE_PRIORITY = -2;\nconst styles = ({\n  root: {\n    ...LY_COMMON_STYLES.fill\n  }\n});\n\n@Directive({\n  selector: '[lyTooltip]',\n  exportAs: 'lyTooltip'\n})\nexport class LyTooltip implements OnInit, OnDestroy {\n  /** @docs-private */\n  readonly classes = this._theme.addStyleSheet(styles, STYLE_PRIORITY);\n  private _tooltip: string | TemplateRef<any> | null;\n  private _tooltipOverlay: OverlayFromTemplateRef;\n  private _listeners = new Map<string, EventListenerOrEventListenerObject>();\n  private _scrollSub: Subscription;\n  private _scrollVal = 0;\n  private _showTimeoutId: number | null;\n  private _hideTimeoutId: number | null;\n  @Input('lyTooltip')\n  set tooltip(val: string | TemplateRef<any>) {\n    this._tooltip = val;\n  }\n  get tooltip() {\n    return this._tooltip;\n  }\n  @Input() lyTooltipShowDelay: number = 0;\n  @Input() lyTooltipHideDelay: number = 0;\n  @Input('lyTooltipPlacement') placement: Placement;\n  @Input('lyTooltipXPosition') xPosition: XPosition;\n  @Input('lyTooltipYPosition') yPosition: YPosition;\n  constructor(\n    private _theme: LyTheme2,\n    private _overlay: LyOverlay,\n    private _el: ElementRef,\n    private _renderer: Renderer2,\n    private _cd: ChangeDetectorRef,\n    focusState: LyFocusState,\n    ngZone: NgZone,\n    scroll: WindowScrollService\n  ) {\n    if (Platform.isBrowser) {\n      const element: HTMLElement = _el.nativeElement;\n      if (!Platform.IOS && !Platform.ANDROID) {\n        this._listeners\n          .set('mouseenter', () => this.show())\n          .set('mouseleave', () => this.hide());\n      } else {\n        this._listeners.set('touchstart', () => this.show());\n      }\n\n      this._listeners.forEach((listener, event) => element.addEventListener(event, listener));\n\n      this._scrollSub = scroll.scroll$.subscribe(() => {\n        if (this._tooltipOverlay) {\n          this._scrollVal++;\n          if (this._scrollVal > 10) {\n            ngZone.run(() => this.hide(0));\n            this._scrollVal = 0;\n          }\n        }\n      });\n\n      focusState.listen(element).subscribe(ev => {\n        if (ev.by === 'keyboard' && ev.event.type === 'focus') {\n          ngZone.run(() => this.show());\n        } else if (ev.event.type === 'blur') {\n          ngZone.run(() => this.hide());\n        }\n      });\n    }\n  }\n\n  ngOnInit() {\n    if (!this.placement && !this.xPosition && !this.yPosition) {\n      this.placement = DEFAULT_PLACEMENT;\n    }\n  }\n\n  ngOnDestroy() {\n    this.hide(0);\n\n    // Clean up the event listeners set in the constructor\n    this._listeners.forEach((listener, event) => {\n      this._el.nativeElement.removeEventListener(event, listener);\n    });\n\n    if (this._scrollSub) {\n      this._scrollSub.unsubscribe();\n    }\n  }\n\n  show(delay?: number) {\n    delay = typeof delay === 'number' ? delay : this.lyTooltipShowDelay;\n    if (this._hideTimeoutId) {\n      clearTimeout(this._hideTimeoutId);\n      this._hideTimeoutId = null;\n    }\n    if (!this._tooltipOverlay && this.tooltip && !this._showTimeoutId) {\n\n      this._showTimeoutId = <any>setTimeout(() => {\n        const rect = this._el.nativeElement.getBoundingClientRect();\n        const tooltip = this._tooltipOverlay = this._overlay.create(this.tooltip, undefined, {\n          styles: {\n            top: rect.y,\n            left: rect.x\n          },\n          classes: [\n            this._theme.addStyle('LyTooltip', (theme: ThemeVariables) => ({\n              borderRadius: '4px',\n              ...theme.tooltip.root,\n              fontSize: '10px',\n              padding: '6px 8px',\n              opacity: 0,\n              transition: `opacity ${theme.animations.curves.standard} 300ms`,\n              [theme.getBreakpoint('XSmall')]: {\n                padding: '8px 16px',\n                fontSize: '14px',\n              }\n            }), null, null, STYLE_PRIORITY)\n          ],\n          host: this._el.nativeElement,\n        });\n        const position = getPosition(this.placement, this.xPosition, this.yPosition, this._el.nativeElement, tooltip.containerElement, this._theme.config, 13);\n        tooltip.containerElement.style.transform = `translate3d(${position.x}px,${position.y}px,0)`;\n\n        this._theme.requestAnimationFrame(() => {\n          this._theme.addStyle('lyTooltip:open', ({\n            opacity: 1,\n          }), tooltip.containerElement, null, STYLE_PRIORITY);\n        });\n\n        this._showTimeoutId = null;\n        this._markForCheck();\n      }, delay);\n    }\n  }\n\n  hide(delay?: number) {\n    const tooltipOverlay = this._tooltipOverlay;\n    delay = typeof delay === 'number' ? delay : this.lyTooltipHideDelay;\n    if (this._showTimeoutId) {\n      clearTimeout(this._showTimeoutId);\n      this._showTimeoutId = null;\n    }\n    if (tooltipOverlay && !this._hideTimeoutId) {\n\n      this._hideTimeoutId = <any>setTimeout(() => {\n        this._renderer.removeClass(tooltipOverlay.containerElement, this._theme.addStyle('lyTooltip:open', null));\n        setTimeout(() => tooltipOverlay.destroy(), 300);\n        this._tooltipOverlay = null;\n\n        this._hideTimeoutId = null;\n        this._markForCheck();\n      }, delay);\n    }\n  }\n\n  toggle() {\n    if (this._tooltipOverlay) {\n      this.hide();\n    } else {\n      this.show();\n    }\n  }\n\n  private _markForCheck() {\n    this._cd.markForCheck();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { LyTooltip } from './tooltip';\nimport { LyOverlayModule } from '@alyle/ui';\n\n@NgModule({\n  imports: [LyOverlayModule],\n  declarations: [LyTooltip],\n  exports: [LyTooltip]\n})\nexport class LyTooltipModule { }\n"],"names":[],"mappings":"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"}
